---
<<<<<<< HEAD
title: "Group 18"
=======
  title: "Group 18"
>>>>>>> 708b41b87fc17265a28bcd15ebce49781d95bf8b
author: "top"
date: "24 марта 2017 г."
output: html_document
---
  
  Это файл для изучения принципа действия нашего проекта и экспериментов. тут должен быть пройден весь тернистый путь от закачки до выгрузки итоговых весов в портфеле.

1 шаг. Скачивание изначальных данных.

```{r}
library(quantmod) 
library(rusquant) 
library(lubridate)
interval <- 60
d<-Sys.Date()
day(d)=day(d)-(interval*4)
getSymbols(Symbols="SBER", from=d, to = Sys.Date(), src = "Finam", period = "day", auto.assign = TRUE) 
getSymbols(Symbols="TATN", from=d, to = Sys.Date(), src = "Finam", period = "day", auto.assign = TRUE)
getSymbols(Symbols="ROSN", from=d, to = Sys.Date(), src = "Finam", period = "day", auto.assign = TRUE)
getSymbols(Symbols="FEES", from=d, to = Sys.Date(), src = "Finam", period = "day", auto.assign = TRUE) 
getSymbols(Symbols="BANE", from=d, to = Sys.Date(), src = "Finam", period = "day", auto.assign = TRUE) 
getSymbols(Symbols="AFLT", from=d, to = Sys.Date(), src = "Finam", period = "day", auto.assign = TRUE) 
firms <- data.frame(SBER[,4], TATN[,4], ROSN[,4], FEES[,4], BANE[,4], AFLT[,4]) 
```

2 шаг. Подсчет доходностей для каждой из фирм.

```{r}
firms$SBERrho<-c(NA, diff(log(firms$SBER.Close))) 
firms$TATNrho<-c(NA, diff(log(firms$TATN.Close))) 
firms$ROSNrho<-c(NA, diff(log(firms$ROSN.Close))) 
firms$FEESrho<-c(NA, diff(log(firms$FEES.Close))) 
firms$BANErho<-c(NA, diff(log(firms$BANE.Close))) 
firms$AFLTrho<-c(NA, diff(log(firms$AFLT.Close))) 
```

3 шаг. Подсчет плавающего СКО за период.

```{r}
sd30 <- rollapplyr(firms[,7:12], 30, sd, fill=NA) 
```

4 шаг...

<<<<<<< HEAD
Я сделала первый шаг - привязала свой R <3##Загружаем данные
##Загружаем данные
```{r}
library(quantmod) 
library(rusquant) 
getSymbols(Symbols="SBER", from='2017-01-01', to = Sys.Date(), src = "Finam", period = "day", auto.assign = TRUE) 
#chartSeries(SBER, theme="white") 
#addEMA(n=20, col="blue") 
#plot(SBER$SBER.Close) 

getSymbols(Symbols="TATN", from='2017-01-01', to = Sys.Date(), src = "Finam", period = "day", auto.assign = TRUE) 

firms <- data.frame(SBER[,4], TATN[,4]) 
#доходности
sbrrho <- diff(log(firms$SBER.Close)) 
firms$SberRho<-c(NA, sbrrho) 
tatnrho <- diff(log(firms$TATN.Close)) 
firms$TatnRho<-c(NA, tatnrho) 

plot(firms$TatnRho[2:43], type="l") 
#tseries::adf.test(firms$TatnRho[2:43]) 
fff<-rollapplyr(firms[,3:4], 7, sd, fill=NA) 


lag_apply <- function(x, n, callback){ 
k = length(x); 
result = rep(0, k); 
for(i in 1 : (k - n + 1)){ 
result[i] <- callback(x[i : (i + n -1)]); 
} 
return(result); 
} 

firms34<-firms[1:43,3] 

asd<-lag_apply(firms34, 7, function(firms34){sd(firms34)}) 


ffffff<-data.frame(fff[,1], asd)
```

=======
>>>>>>> 708b41b87fc17265a28bcd15ebce49781d95bf8b
